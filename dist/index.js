"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t="single",e="range",n="single",r="double",a="custom";function i(t,e){return[e]}function s(t,e){return[t,e].slice(0).sort((function(t,e){return t.ms-e.ms}))}function o(t,e){return 2===t.length?[e]:function(t,e){if(0===t.length)return[e];var n=t[0],r=t[1];return 1===t.length?s(n,e):n.formatted===e.formatted?[n,e]:r.formatted===e.formatted?[r,e]:s(Math.abs(n.ms-e.ms)<Math.abs(r.ms-e.ms)?r:n,e)}(t,e)}function u(t){return new(Function.prototype.bind.apply(Date,[null].concat(t.split("-"))))}function h(t,e){var n=e[0],r=e[1];return m(t,n)&&d(t,r)}function f(t,e){return l(e,t)}function c(t,e){return l(t,e)}function l(t,e){return u(t).valueOf()-u(e).valueOf()==864e5}function d(t,e){return t<e}function m(t,e){return t>e}function D(t,e){return t===e}function v(t,e){return t===e}function y(t,e){return new Date(t,e)}function g(t,e){var n=e.disabledDates;void 0===n&&(n=[]);var r=e.maxDate;void 0===r&&(r="");var a=e.minDate;return void 0===a&&(a=""),a&&d(t,a)||r&&m(t,r)||function(t,e){return-1!==e.indexOf(t)}(t,n)}function M(t){return t<10?"0"+t:t}function O(t,e,n,r){void 0===r&&(r={isOtherMonthDay:!1,firstDayOfWeek:1});var a=r.isOtherMonthDay,i=r.firstDayOfWeek,s=new Date(t,e,n);this.ms=s.valueOf(),this.dayOfWeek=(s.getDay()-i+7)%7,this.year=s.getFullYear(),this.month=s.getMonth(),this.day=s.getDate(),this.actualMonthNumber=this.month+1,this.formatted=[this.year,this.actualMonthNumber,this.day].map(M).join("-"),this.isWeekend=function(t){var e=t.getDay();return 0===e||6===e}(s),this.isToday=function(t){var e=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}(s),this.isOtherMonthDay=a}O.fromString=function(t,e){void 0===e&&(e={firstDayOfWeek:1});var n=e.firstDayOfWeek,r=t.split("-");return new O(r[0],r[1]-1,r[2],{firstDayOfWeek:n})},O.prototype.isBetween=function(t){var e=t.currentHoveredDate,n=t.captureThirdDate,r=t.selectedDates;if(0===r.length)return!1;var a=this.formatted,i=r[0],s=r[1],o=e&&e.formatted,u=i&&i.formatted,f=s&&s.formatted;return!s&&o?h(a,[u,o])||h(a,[o,u]):n&&o?h(a,[u,o])||h(a,[o,f]):h(a,[u,f])},O.prototype.isSelected=function(t){return void 0===t&&(t=[]),function(t,e){return e.some((function(e){return D(e,t)}))}(this.formatted,t.map((function(t){return t.formatted})))};var p={};function w(t){for(var e=t.numberOfMonths,n=t.viewMode,r=t.month,i=t.year,s=t.firstDayOfWeek,o=[],u=r+(n===a?e:p[n]),h=r,f=i,c=r;h<u;){var l=y(f,c),d=l.getFullYear(),m=l.getMonth(),D=k(d,m,s),v=S(D[0],s),g=b(D[D.length-1],s);o.push({dates:v.concat(D,g),month:m,year:d}),f=d,c=m+1,h++}return o}function S(t,e){return void 0===e&&(e=1),function(t,e,n,r){void 0===r&&(r=1);var a=[],i=n-1,s=31;for(;a.length<t;){var o=new O(e,i,s,{isOtherMonthDay:!0,firstDayOfWeek:r});v(n,o.month)||a.unshift(o),s--}return a}(t.dayOfWeek,t.year,t.month,{firstDayOfWeek:e})}function k(t,e,n){void 0===n&&(n=1);for(var r=[],a=1;a<=31;a++)r.push(new O(t,e,a,{firstDayOfWeek:n}));return r.filter((function(t){return v(e,t.month)}))}function b(t,e){return void 0===e&&(e=1),function(t,e,n,r){void 0===r&&(r=1);for(var a=[],i=n+1,s=1;s<=t;s++){var o=new O(e,i,s,{isOtherMonthDay:!0,firstDayOfWeek:r});a.push(o)}return a}(6-t.dayOfWeek,t.year,t.month,{firstDayOfWeek:e})}function Y(t){var e=t.currentYear,n=t.currentMonth,r=t.minDate,a=t.maxDate;return 1===t.step?function(t,e,n){if(!t)return!1;var r=t.split("-"),a=r[0],i=r[1],s=r[2],o=new Date(a,i-1,s),u=o.getFullYear(),h=o.getMonth(),f=n+1;return D(u,e)&&d(h,f)}(a,e,n):function(t,e,n){if(!t)return!1;var r=t.split("-"),a=r[0],i=r[1],s=r[2],o=new Date(a,i-1,s),u=o.getFullYear(),h=o.getMonth(),f=n-1;return D(u,e)&&m(h,f)}(r,e,n)}p[n]=1,p[r]=2;var F={};function N(t,e,n){return F[t](e,n)}F[n]=function(t,e){var n=e||new Date,r=n.getFullYear(),a=n.getMonth();return[{year:r,month:a}]},F[r]=function(t,e){var n=e||new Date,r=n.getFullYear(),a=n.getMonth(),i=y(n.getFullYear(),n.getMonth()+1),s=i.getFullYear(),o=i.getMonth();return[{year:r,month:a},{year:s,month:o}]},F[a]=function(t,e){for(var n=e||new Date,r=[],a=n.getMonth()+t,i=n.getMonth();i<a;i++){var s=y(n.getFullYear(),i);r.push({year:s.getFullYear(),month:s.getMonth()})}return r};var W={};W[n]={prevPage:function(){},nextPage:function(){}},W[r]={prevPage:function(){},nextPage:function(){}};var x={};function P(t,e){return/^[a-z]{2,3}(-[A-Za-z]{2})?$/.test(t)||(t=navigator?navigator.language:"en"),x.hasOwnProperty(t)||(x[t]=function(t,e){void 0===e&&(e=1);var n=e%7,r=new Date,a=r.getFullYear(),i=r.getMonth(),s=r.getDay(),o=Array(12).fill().map((function(e,n){var r=new Date(a,n);return{short:r.toLocaleString(t,{month:"short"}),full:r.toLocaleString(t,{month:"long"})}})),u=r.getDate()-s+n,h=Array(7).fill().map((function(e,n){var r=new Date(a,i,u+n);return{short:r.toLocaleString(t,{weekday:"short"}),full:r.toLocaleString(t,{weekday:"long"})}}));return{months:o,days:h}}(t,e)),x[t]}var B={name:"RenderlessCalendar",props:{startDate:{type:[Date,String],default:function(){return new Date}},viewMode:{type:String,validator:function(t){return-1!==[n,r,a].indexOf(t)},default:n},customNumberOfMonths:{type:Number,default:0},mode:{type:String,validator:function(n){return-1!==[t,e].indexOf(n)},default:t},locale:{type:[String,Object],default:""},minDate:{type:String,default:null},maxDate:{type:String,default:null},preventOutOfRange:{default:!0,type:Boolean},captureThirdDate:{type:Boolean,default:!1},dateSelectStrategy:{type:Function,default:null},defaultSelectedDates:{type:Array,default:function(){return[]}},captureHover:{type:Boolean,default:!0},disabledDates:{type:Array,default:function(){return[]}},markedDates:{type:Array,default:function(){return[]}},firstDayOfWeek:{type:Number,default:1}},data:function(){return{calendar:null,selectedDates:[],currentMonth:null,currentYear:null,currentHoveredDate:null,viewState:[]}},created:function(){this.selectedDates=this.defaultSelectedDates.map(O.fromString);var t,e="string"==typeof this.startDate?new Date(this.startDate):this.startDate;this.currentMonth=e.getMonth(),this.currentYear=e.getFullYear(),this.viewState=N(this.viewMode,this.customNumberOfMonths,e),this.viewNavigator=(t=this.viewMode,W[t]),this.calendar=Object.freeze(w({numberOfMonths:this.customNumberOfMonths,month:this.currentMonth,viewMode:this.viewMode,year:this.currentYear,firstDayOfWeek:this.firstDayOfWeek}))},computed:{localeStrings:function(){return"string"==typeof this.locale?P(this.locale,this.firstDayOfWeek):this.locale},weekDayNames:function(){return this.localeStrings.days},monthNames:function(){return this.localeStrings.months.map((function(t,e){return{short:t.short,full:t.full,id:e}}))},monthsList:function(){return function(t){for(var e=t.currentMonth,n=t.currentYear,r=t.monthNames,a=t.viewState,i=e,s=[],o=i;o<=i+12;o++){var u=new Date(n,o),h=u.getFullYear(),f=u.getMonth(),c=r[f];s.push({isActive:a.some(l(h,f)),id:h+"-"+f,short:c.short,full:c.full,month:f,year:h})}return s;function l(t,e){return function(n){return n.year===t&&n.month===e}}}({currentMonth:this.currentMonth,currentYear:this.currentYear,monthNames:this.monthNames,viewState:this.viewState})},canGoToPrevMonth:function(){var t=this.viewState[0],e=t.month,n=t.year;return!Y({minDate:this.minDate,maxDate:this.maxDate,currentMonth:e,currentYear:n,step:-1})},canGoToNextMonth:function(){var t=this.viewState[this.viewState.length-1],e=t.month,n=t.year;return!Y({minDate:this.minDate,maxDate:this.maxDate,currentMonth:e,currentYear:n,step:1})}},methods:{onDateSelect:function(t){this.setDates(this.dateChangeHangler(this.selectedDates,t))},onDateMouseOver:function(t){this.currentHoveredDate=t},onDateMouseOut:function(){this.currentHoveredDate=null},setDates:function(t){this.selectedDates=t,this.$emit("onDateChange",t)},resetDates:function(t){this.setDates(function(t,e){return Number.isNaN(e)?[]:t.filter((function(t,n){return n!==e}))}(this.selectedDates,t))},prevPage:function(t){var e=this.viewState,a=this.viewMode,i=this.customNumberOfMonths,s=e[0],o=s.year,u=s.month,h=[];if(t&&(u=t+1),!(this.shouldPreventMonthChange(o,u,-1)||u<0)){var f=y(o,u-1),c=w({numberOfMonths:i,year:f.getFullYear(),month:f.getMonth(),viewMode:a,firstDayOfWeek:this.firstDayOfWeek});if(a===n)h=[{year:f.getFullYear(),month:f.getMonth()}];else if(a===r){var l=e[0];h=[{year:f.getFullYear(),month:f.getMonth()},l]}this.calendar=c,this.viewState=h}},nextPage:function(t){var e=this.viewMode,a=this.viewState,i=this.customNumberOfMonths,s=[],o=e===n?a[0]:a[1],u=o.year,h=o.month;if(t&&(h=t-1),!(this.shouldPreventMonthChange(u,h,1)||h<0)){if(e===r){var f=a[0];u=f.year,h=f.month}var c=y(u,h+1),l=w({numberOfMonths:i,year:c.getFullYear(),month:c.getMonth(),viewMode:e,firstDayOfWeek:this.firstDayOfWeek});if(e===n)s=[{year:c.getFullYear(),month:c.getMonth()}];else if(e===r){var d=a[1],m=y(u,h+2);s=[d,{year:m.getFullYear(),month:m.getMonth()}]}this.calendar=l,this.viewState=s}},shouldPreventMonthChange:function(t,e,n){return this.preventOutOfRange&&Y({currentMonth:e,currentYear:t,minDate:this.minDate,maxDate:this.maxDate,step:n})},setMonth:function(t){var e=t.month,n=t.year,r=this.viewMode,a=this.customNumberOfMonths,i=N(this.viewMode,this.customNumberOfMonths,new Date(n,e+1));this.calendar=w({numberOfMonths:a,viewMode:r,month:e,year:n,firstDayOfWeek:this.firstDayOfWeek}),this.viewState=i},isBetween:function(t){return this.captureHover&&t.isBetween({currentHoveredDate:this.currentHoveredDate,captureThirdDate:this.captureThirdDate,selectedDates:this.selectedDates})},isSelected:function(t){var n=this.currentHoveredDate&&this.mode===e&&1===this.selectedDates.length;return t.isSelected(this.selectedDates)||n&&t.formatted===this.currentHoveredDate.formatted},isDisabled:function(t){return g(t.formatted,{disabledDates:this.disabledDates,maxDate:this.maxDate,minDate:this.minDate})},isOneDayAfter:function(t){return this.selectedDates.map((function(t){return t.formatted})).some((function(e){return c(t.formatted,e)}))},isOneDayBefore:function(t){return this.selectedDates.map((function(t){return t.formatted})).some((function(e){return f(t.formatted,e)}))},isOneDayBeforeFirst:function(t){var e=this.selectedDates[0];return e&&f(t.formatted,e.formatted)},isOneDayAfterFirst:function(t){var e=this.selectedDates[0];return e&&c(t.formatted,e.formatted)},isOneDayBeforeLast:function(t){var e=this.selectedDates[1];return e&&f(t.formatted,e.formatted)},isOneDayAfterLast:function(t){var e=this.selectedDates[1];return e&&c(t.formatted,e.formatted)},isFirst:function(t){var e=this.selectedDates[0];return e&&D(t.formatted,e.formatted)},isLast:function(t){var e=this.selectedDates[1];return e&&D(t.formatted,e.formatted)},isMarked:function(t){return function(t,e){return-1!==e.indexOf(t)}(t.formatted,this.markedDates)},getModifiers:function(t){return{isBetween:this.isBetween(t),isSelected:this.isSelected(t),isDisabled:this.isDisabled(t),isOneDayAfter:this.isOneDayAfter(t),isOneDayBefore:this.isOneDayBefore(t),isOneDayBeforeFirst:this.isOneDayBeforeFirst(t),isOneDayAfterFirst:this.isOneDayAfterFirst(t),isOneDayBeforeLast:this.isOneDayBeforeLast(t),isOneDayAfterLast:this.isOneDayAfterLast(t),isFirst:this.isFirst(t),isLast:this.isLast(t),isMarked:this.isMarked(t)}}},watch:{mode:{handler:function(n){this.dateChangeHangler=this.dateSelectStrategy||function(n){switch(n){case t:return i;case e:return o;default:throw new Error("unkown mode: "+n)}}(n)},immediate:!0},firstDayOfWeek:function(t){var e=this.viewState[0],n=e.month,r=e.year;this.calendar=Object.freeze(w({numberOfMonths:this.customNumberOfMonths,viewMode:this.viewMode,firstDayOfWeek:t,month:n,year:r}))},defaultSelectedDates:function(t){this.setDates(t.map(O.fromString))}},render:function(){return this.$scopedSlots.default({weekDayNames:this.weekDayNames,monthNames:this.monthNames,monthsList:this.monthsList,calendar:this.calendar,selectedDates:this.selectedDates,currentMonth:this.currentMonth,currentYear:this.currentYear,canGoToPrevMonth:this.canGoToPrevMonth,canGoToNextMonth:this.canGoToNextMonth,prevPage:this.prevPage,nextPage:this.nextPage,resetDates:this.resetDates,setMonth:this.setMonth,onDateMouseOut:this.onDateMouseOut,onDateMouseOver:this.onDateMouseOver,onDateSelect:this.onDateSelect,getModifiers:this.getModifiers})}};exports.RenderlessCalendar=B;
